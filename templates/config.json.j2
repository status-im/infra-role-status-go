{
  "LogLevel": "{{ mailsrv_log_level }}",
  "IPCEnabled": true,
  "HTTPEnabled": true,
  "HTTPHost": "0.0.0.0",
  "HTTPPort": {{ mailsrv_node_rpc_port }},
  "MaxPeers": 5000,
  "APIModules": "eth,web3,admin,waku,wakuext",
  "DataDir": "/data",
  "EnableNTPSync": true,
  "ListenAddr": "0.0.0.0:{{ mailsrv_node_listen_port }}",
  "AdvertiseAddr": "{{ ansible_host }}",
  "NodeKey": "{{ node_key }}",
  "NetworkID": {{ mailsrv_eth_network }},
  "Rendezvous": true,
  "RegisterTopics": [ "{{ mailsrv_topic }}" ],
  "RequireTopics": { "whisper": { "min": 3, "max": 4 } },
  "WakuConfig": {
    "Enabled": {{ mailsrv_waku_enabled | to_json }},
    "EnableMailServer": true,
    "EnableConfirmations": {{ mailsrv_confirmations_enabled | to_json }},
    "FullNode": true,
    "MailServerPassword": "{{ mailsrv_wnode_password }}",
    "DataDir": "/data/waku",
    "EnableRateLimiter": true,
    "RateLimitIP": 5,
    "RateLimitPeerID": 5,
    "RateLimitTolerance": 3,
    "MailServerDataRetention": 30,
    "DatabaseConfig": {
      "PGConfig": {
        "Enabled": true,
        "URI": "postgres://{{ mailsrv_db_user }}:{{ mailsrv_db_pass }}@{{ mailsrv_db_host }}:{{ mailsrv_db_port }}/{{ mailsrv_waku_db_name }}{{ mailsrv_db_opts }}"
      }
    }
  },
  "PushNotificationServerConfig": {
    "Enabled": {{ mailsrv_pn_server_enabled | to_json }},
    "GorushURL": "{{ mailsrv_pn_server_gorush_url }}"
  },
  "ClusterConfig": {
    "Enabled": true,
    "BootNodes": [
{% for node in boot_nodes %}
      "{{ node }}"{{ "," if not loop.last }}
{% endfor %}
    ],
    "RendezvousNodes": [
{% for node in rendezvous_addresses %}
      "{{ node }}"{{ "," if not loop.last }}
{% endfor %}
    ]
  }
}
